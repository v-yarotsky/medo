#!/usr/bin/env ruby

require 'rubygems'
require 'bundler/setup'
require 'fileutils'
require 'gli'

puts $:
require 'medo'
require 'medo/file_task_storage'

include GLI::App
include Medo

program_desc 'Simple CLI To-Do manager'
version VERSION

commands_from 'medo/commands'

Signal.trap("SIGINT") do
  puts "Terminating"
  exit 1
end

default_command :list

TASKS_FILE = File.expand_path("../tasks.txt", File.dirname(__FILE__))
puts TASKS_FILE

FileTaskStorage.using_storage(TASKS_FILE) do |the_storage|
  define_singleton_method(:storage) { the_storage }
  exit run(ARGV)
end

